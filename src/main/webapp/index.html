<!DOCTYPE html>
<html ng-app="marcus" lang="no" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <meta name="viewport" content="width=device-width, user-scalable=no" />
    <base href=".">
    <title>Marcus - søk</title>
    <meta name="description" content="Search Marcus data"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <link rel="shortcut icon" type="image/x-icon" href="http://marcus.uib.no/img/favicon.ico"/>
    <link rel="stylesheet" href="semantic/dist/semantic.min.css"/>
    <link rel="stylesheet" href="js/lib/typeahead/css/main.css"/>
    <link rel="stylesheet" href="js/lib/typeahead/css/normalize.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/>
    <link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css"/>
    <link href="http://fonts.googleapis.com/css?family=IM+Fell+Great+Primer" rel="stylesheet" type="text/css">
    
    <link rel="stylesheet" type="text/css" media="screen" href="css/marcus.css"/>
    <link rel="stylesheet" type="text/css" media="print" href="css/print.css"/>
    <link rel="stylesheet" href="css/bootstrap-pagination.css"/>
    <style>
        .ui.items > .item .extra button {
            margin-right: 0;
        }
        .ui.items > .item .extra ul {
            padding-left: 0;
        }
        .ui.items > .item .extra ul li {
            margin: 0 8px 8px 12px;
        }
        .ui.items > .item .meta span.right, .ui.items > .item .image span.right {
            float: right;
        }
        .ui.items > .item .image .ui.attached.label {
            position: relative;
        }
    </style>
</head>
<body class="site" ng-controller="freeTextSearch">
<div class="ui right sidebar main-nav inverted vertical menu">
    <div class="item">
        <div class="ui massive vertical inverted menu">
            <div class="item"><a href="http://marcus.uib.no/collections"><i style="color: #aaa;" class="fa fa-th fa-fw"></i> Samlinger</a></div>
            <div class="item"><a href="?filter=type.exact%23Fotografi&filter=type.exact%23Album&filter=type.exact%23Grafikk&filter=type.exact%23Postkort"><i style="color: #aaa;" class="fa fa-picture-o fa-fw"></i> Bilder</a></div>
            <div class="item"><a href="http://marcus.uib.no/events"><i style="color: #aaa;" class="fa fa-calendar fa-fw"></i> Hendelser</a></div>
            <div class="item"><a href="http://marcus.uib.no/albums"><i style="color: #aaa;" class="fa fa-book fa-fw"></i> Album</a></div>
            <div class="item"><a href="http://marcus.uib.no/exhibitions"><i style="color: #aaa;" class="fa fa-university fa-fw"></i> Utstillinger</a></div>
        </div>
    </div>
    <div class="item">
        <div class="ui massive vertical inverted menu">
            <div class="item"><a href="http://marcus.uib.no/about-marcus"><i style="color: #aaa;" class="fa fa-archive"></i> Om Marcus</a></div>
            <div class="item"><a href="http://sparql.ub.uib.no"><i style="color: #aaa;" class="fa fa-cubes"></i> Åpne data (Sparql)</a></div>
            <div class="item"><a href="http://marcus.uib.no/technology.html"><i style="color: #aaa;" class="fa fa-cog"></i> Teknologi</a></div>
            <div class="item"><a href="http://marcus.uib.no/stats"><i style="color: #aaa;" class="fa fa-bar-chart-o"></i> Statistikk</a></div>
        </div>
    </div>
    
    <div ng-controller="Ctrl" class="item">
        <div class="ui massive vertical inverted menu">
            <div class="item" ng-click="changeLanguage('no')" translate="header.buttonLangNo"></div>
            <div class="item" ng-click="changeLanguage('en')" translate="header.buttonLangEn"></div>
        </div>
    </div>

    <div class="item">
        <div class="ui massive vertical inverted menu">
            <a class="item" href="http://marcus.uib.no/cart.html">
                <i style="color: #aaa;" class="fa fa-lg fa-shopping-cart"></i> Handlekurv <span style="margin-top: -8px;" class="label label-primary simpleCart_quantity"></span>
            </a>
        </div>
    </div>
</div>

<div class="ui left sidebar facet-nav vertical menu">
    <div class="item">
        <div class="menu">
            <div class="item">
                <label for="docPerPage"><i class="fa fa-eye" aria-hidden="true"></i> <strong translate="filters.show"></strong></label>
                <select id="docPerPage" style="display:inline" ng-model="pageSize" ng-change="search()">
                    <option value="10">10</option>
                    <option value="20">20</option>
                    <option value="30">30</option>
                    <option value="50">50</option>
                    <option value="100">100</option>
                </select>
            </div>
            <div class="item">
                <label for="sort"><i class="fa fa-sort" aria-hidden="true"></i> <strong class="tablet or lower uihidden" translate="filters.sort"></strong></label>
                <select id="sort" ng-model="sortBy" ng-change="search()">
                    <option selected="selected" translate="filters.relevance" value=""></option>
                    <option translate="filters.sortAsc" value="identifier:asc"></option>
                    <option translate="filters.sortDesc" value="identifier:desc"></option>
                    <option translate="filters.availableAsc" value="available:asc"></option>
                    <option translate="filters.availableDesc" value="available:desc"></option>
                    <option translate="filters.dateAsc" value="dateSort:asc"></option>
                    <option translate="filters.dateDesc" value="dateSort:desc"></option>
                </select>
            </div>
        </div>
    </div>
    
    <div class="facets" ng-include="'partials/facets.html'"></div>
</div>

<div include-replace ng-include="'partials/header.html'"></div>

<div class="pusher">
    <div class="ui content container">
        <!-- Loading gif -->        
        <div class="ui active dimmer blackbox-loading">
            <div class="ui huge loader"></div>
        </div>
        <!-- Controller starts here-->
        <div id="searchController">
            <div id="search-header">
                <div class="masthead">
                    <!--input type="hidden" name="index" value="admin"-->
                    <div class="Typeahead ui equal width stackable grid">
                        <div class="u-posRelative ui sixteen wide column">
                            <div class="ui massive icon fluid input test">
                                <input class="Typeahead-hint" type="text" tabindex="-1" readonly="readonly"/>
                                <input class="Typeahead-input"
                                       id="search-input"
                                       type="text"
                                       name="q"
                                       ng-model="queryString"
                                       ng-keyup="($event.keyCode==13 || queryString==='')&&search()"
                                       placeholder="{{ 'searchContainer.placeholder' | translate }}"
                                       autofocus
                                       autocomplete="off"/>
                                <i ng-click="search()" class="search link icon"></i>
                            </div>
                            <div class="Typeahead-menu"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="active-filters-reset-help" class="ui container">
                <!--Selected filters -->
                <div ng-cloak ng-if="selectedFilters.length > 0" class="ui segment selected-filter">
                    <strong translate="filters.active"></strong>
                    <div ng-repeat="filter in selectedFilters" class="ui relaxed horizontal list">
                        <div class="item">
                            <a class="filter" ng-click="removeFilter(filter)" ng-class="filter | filterType">
                                {{filter.split('#')[1]}}<i class="delete icon"></i>
                            </a>
                        </div>
                    </div>
                </div>
                <div class="ui basic compact segment">
                    <div class="ui horizontal list">
                        <!-- Reset search -->
                        <div class="item">
                            <a ng-click="resetSearch()" target="_self" title="Nullstill søk">
                                <i class="delete circle icon"></i><span translate="searchContainer.reset"></span>
                            </a>
                        </div>
                        <!-- Search tips -->
                        <div class="item">
                            <a class="search-help-button" accesskey="72" title="Søketips">
                                <i class="help icon"></i><span translate="searchContainer.help"></span>
                            </a>
                        </div>
                        <div class="item mobile uihidden">
                            <span>
                                <label for="docPerPage"><i class="fa fa-eye mobile only" aria-hidden="true"></i> <strong class="mobile uihidden" translate="filters.show"></strong></label>
                                <select id="docPerPage" style="display:inline" ng-model="pageSize" ng-change="search()">
                                    <option value="10">10</option>
                                    <option value="20">20</option>
                                    <option value="30">30</option>
                                    <option value="50">50</option>
                                    <option value="100">100</option>
                                </select>
                            </span>
                        </div>
                        <div class="item mobile uihidden">
                            <span>
                                <label for="sort"><i class="fa fa-sort mobile only" aria-hidden="true"></i> <strong class="mobile uihidden" translate="filters.sort"></strong></label>
                                <select id="sort" ng-model="sortBy" ng-change="search()">
                                    <option selected="selected" translate="filters.relevance" value=""></option>
                                    <option translate="filters.sortAsc" value="identifier:asc"></option>
                                    <option translate="filters.sortDesc" value="identifier:desc"></option>
                                    <option translate="filters.availableAsc" value="available:asc"></option>
                                    <option translate="filters.availableDesc" value="available:desc"></option>
                                    <option translate="filters.dateAsc" value="dateSort:asc"></option>
                                    <option translate="filters.dateDesc" value="dateSort:desc"></option>
                                </select>
                            </span>
                        </div>
                    </div>
                </div>
               
                <!-- Search help info -->
                <div class="search-help ui modal">
                    <i class="close icon"></i>
                    <div class="header" translate="searchHint.header"></div>
                    <div class="image content">
                        <div class="image">
                            <i class="search icon"></i>
                        </div>
                        <div class="description">
                            <h4 translate="searchHint.andOr"></h4>
                            <ul translate="searchHint.andOrTxt"></ul>

                            <h4 translate="searchHint.not"></h4>
                            <ul translate="searchHint.notTxt"></ul>

                            <h4 translate="searchHint.truncation"></h4>
                            <ul translate="searchHint.truncationTxt"></ul>

                            <h4 translate="searchHint.fields"></h4>
                            <span translate="searchHint.fieldsTxt"></span>

                            <h4 translate="searchHint.fuzzy"></h4>
                            <ul translate="searchHint.fuzzyTxt"></ul>
                        </div>
                    </div>
                </div>
            </div>


            <!--uib-progressbar  class="blackbox-loading" ng-show="show_loading" value="dynamic" style="height:100px;"></uib-progressbar-->
            <!-- Search results -->
            <div ng-cloak ng-show="ready" class="ui container">
                <div class="search-results ui equal width grid">
                    <!--Starting with facets-->
                    <div id="filters" ng-cloak class="ng-cloak four wide column tablet or lower uihidden">
                        <div class="facets">
                            <div ng-include="'partials/facets.html'" include-replace></div>
                        </div>
                    </div>

                    <!-- No hits-->
                    <div ng-if="ready && results.hits.total === 0" class="no-hits ui column">
                        <div class="ui text ui center aligned">
                            <div class="ui large blue message">
                                <h1 style="font-size: 2em;" class="ui icon header" translate="results.emptyResult"></h1>
                            </div>
                        </div>
                    </div>

                    <!-- Internal error on executing search-->
                    <div ng-if="ready && results.error" class="no-hits ui column">
                        <div class='ui large red message'>
                            <div class="header">
                                Søket ditt kan ikke utføres
                            </div>
                            <ul class="list">
                                <li>
                                    Det inneholder sannsynligvis disse spesialtegnene:
                                    <code> + - = &#x26;&#x26; || &#x3E; &#x3C; ! ( ) { } [ ] ^ ~ &#x22; * ? : \ / </code>
                                </li>
                                <li>
                                    Hvis man skulle søke etter reserverte tegn, må man ha omvendt skråstrek foran.
                                    F.eks søk etter <code> D/S </code> må gjøres som <code> D\/S </code>
                                </li>
                            </ul>
                        </div>
                    </div>

                    <!--Search hits -->
                    <div ng-show="results.hits.total > 0" class="ng-cloak column">
                        <div class="ui one column stackable grid hitlist-settings-top">
                            <div class="row">
                                <div class="column">
                                    <!--Pagination-->
                                    <uib-pagination class="pagination mobile uihidden"
                                                    total-items="results.hits.total"
                                                    items-per-page="pageSize"
                                                    ng-model="currentPage"
                                                    ng-change="triggerSearch()"
                                                    next-text="Neste"
                                                    previous-text="Forrige"
                                                    max-size="3"
                                                    first-text="&laquo;"
                                                    last-text="&raquo;"
                                                    boundary-links="true"
                                                    force-ellipses="true">
                                    </uib-pagination>
                                    <uib-pagination class="pagination mobile only"                                                  
                                                    total-items="results.hits.total"
                                                    items-per-page="pageSize"
                                                    ng-model="currentPage"
                                                    ng-change="triggerSearch()"
                                                    next-text="Neste"
                                                    previous-text="Forrige"
                                                    max-size="1"
                                                    boundary-links="false"
                                                    force-ellipses="true">
                                    </uib-pagination>
                                    <div class="ui mini red mobile only statistic right floated">
                                        <div class="value">{{results.hits.total}}</div>
                                        <div class="label" translate="searchContainer.hitsFeedback" translate-values="{val: results.hits.total}">
                                        </div>
                                    </div>
                                    <div class="ui tiny horizontal red mobile uihidden statistic right floated">
                                        <div class="value">{{results.hits.total}}</div>
                                        <div class="label" translate="searchContainer.hitsFeedback" translate-values="{val: results.hits.total}">
                                        </div>
                                    </div>
                                </div>
                                <!-- Sorting -->
                                <!--<div class="right floated column">
                                    <span>
                                        <label for="docPerPage"><strong translate="filters.show"></strong></label>
                                        <select id="docPerPage" style="display:inline" ng-model="pageSize" ng-change="search()">
                                            <option value="10">10</option>
                                            <option value="20">20</option>
                                            <option value="30">30</option>
                                            <option value="100">100</option>
                                            <option value="200">200</option>
                                            <option value="250">250</option>
                                        </select>

                                        <label for="sort"><strong translate="filters.sort"></strong></label>
                                        <select id="sort" ng-model="sortBy" ng-change="search()">
                                            <option selected="selected" translate="filters.relevance" value=""></option>
                                            <option translate="filters.sortAsc" value="identifier:asc"></option>
                                            <option translate="filters.sortDesc" value="identifier:desc"></option>
                                            <option translate="filters.availableAsc" value="available:asc"></option>
                                            <option translate="filters.availableDesc" value="available:desc"></option>
                                            <option translate="filters.dateAsc" value="dateSort:asc"></option>
                                            <option translate="filters.dateDesc" value="dateSort:desc"></option>
                                        </select>
                                    </span>
                                </div>-->
                            </div>
                        </div>
                        <div class="search-hits">
                            <div class="results-hit ng-cloak">
                                <div class="ui container" ng-show="searching">
                                    <div class="ui basic segment">
                                        <div class="ui active inverted dimmer">
                                            <div class="ui large loader"></div>
                                        </div>
                                        <p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p>
                                    </div>
                                </div>
                                <!-- Search results view -->
                                <div class="ui container" ng-show="!searching">
                                    <div class="ui divided items">
                                        <div ng-repeat="doc in results.hits.hits track by doc._id" class="item">
                                            <div include-replace
                                                 ng-if='doc._type == "document"'
                                                 ng-include="'partials/document-hits.html'"
                                                 style="page-break-inside: avoid;" class="ui item fade">
                                            </div>
                                            <div include-replace
                                                 ng-if='doc._type == "agent"'
                                                 ng-include="'partials/agent-hits.html'"
                                                 style="page-break-inside: avoid;"
                                                 class="ui item fade">
                                            </div>
                                            <div include-replace
                                                 ng-if='doc._source.type == "Monument" || doc._source.type == "Objekt"'
                                                 ng-include="'partials/object-hits.html'"
                                                 style="page-break-inside: avoid;"
                                                 class="ui item fade">
                                            </div>
                                            <div include-replace
                                                 ng-if='doc._source.type == "Skip" || doc._source.type == "Fartøy"'
                                                 ng-include="'partials/vessel-hits.html'"
                                                 style="page-break-inside: avoid;"
                                                 class="ui item fade">
                                            </div>
                                            <div include-replace
                                                 ng-if='doc._source.type == "Emne"'
                                                 ng-include="'partials/concept-hits.html'"
                                                 style="page-break-inside: avoid;"
                                                 class="ui item fade">
                                            </div>
					                        <div include-replace
                                                 ng-if='doc._type == "spatialthing"'
                                                 ng-include="'partials/spatialthing-hits.html'"
                                                 style="page-break-inside: avoid;"
                                                 class="ui item fade">
                                            </div>
                                            <div include-replace
                                                 ng-if='doc._source.type == "Samling" || doc._source.type == "Manuskriptsamling"'
                                                 ng-include="'partials/collection-hits.html'"
                                                 style="page-break-inside: avoid;"
                                                 class="ui item fade">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div> 
                        <div class="ui one column stackable grid hitlist-settings-bottom">
                            <div class="row">
                                <div class="column">
                                <!--Bottom pagination -->
                                <uib-pagination class="pagination mobile uihidden"
                                                total-items="results.hits.total"
                                                items-per-page="pageSize"
                                                ng-model="currentPage"
                                                ng-change="triggerSearch()"
                                                next-text="Neste"
                                                previous-text="Forrige"
                                                max-size="3"
                                                first-text="&laquo;"
                                                last-text="&raquo;"
                                                boundary-links="true"
                                                force-ellipses="true"
                                                ng-show="!searching">
                                </uib-pagination>
                                <uib-pagination class="pagination mobile only"                                                    
                                                total-items="results.hits.total"                                                    
                                                items-per-page="pageSize"                                                     
                                                ng-model="currentPage"                                                     
                                                ng-change="triggerSearch()"
                                                next-text="Neste"                                                     
                                                previous-text="Forrige"                                                     
                                                max-size="3"                                                                                
                                                boundary-links="false"                                                     
                                                force-ellipses="false"
                                                ng-show="!searching">
                                </uib-pagination>
                            </div>
                        </div>
                    </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div include-replace ng-include="'partials/footer.html'"></div>
</div>

<!--JavaScript files -->
<script src="js/lib/typeahead/js/handlebars.js"></script>
<script src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
<script src="js/lib/typeahead/js/jquery.xdomainrequest.min.js"></script>
<script src="js/lib/typeahead/js/typeahead.bundle.js"></script>
<script src="js/lib/typeahead/js/main.js"></script>
<script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular-route.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular-animate.min.js"></script>
<script src="semantic/dist/semantic.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/angular-i18n/1.5.5/angular-locale_nb-no.min.js"></script>
<script src="js/marcus-app.js"></script>
<script src="js/marcus-ux.js"></script>
<script src="js/util/strings.js"></script>
<script src="js/checklist-directive.js"></script>
<script src="js/ui-bootstrap-1.1.2.min.js"></script>
<script src="js/lib/angular-translate/angular-translate.min.js"></script>
<script src="js/lib/angular-translate/angular-translate-loader-static-files.min.js" type="text/javascript"></script>
<script src="https://cdn.jsdelivr.net/messageformat/0.1.8/messageformat.min.js" type="text/javascript"></script>
<script src="https://cdn.jsdelivr.net/messageformat/0.1.8/locale/en.js" type="text/javascript"></script>
<script src="https://cdn.jsdelivr.net/messageformat/0.1.8/locale/no.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/angular-translate-interpolation-messageformat/2.11.0/angular-translate-interpolation-messageformat.min.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.5.5/angular-sanitize.js"></script>
<script src="node_modules/angular-qrcode/angular-qrcode.js"></script>
<script src="//monospaced.github.io/bower-qrcode-generator/js/qrcode.js"></script>


<!--Constants for this particular page-->
<script>
    angular.module("settings", [])
        .constant("mySetting", {
            index: ["marcus-prod"],
            /**type: ["document"],**/
            facets: [
                {
                    "field": "type.exact",
                    "size": 30,
                    "operator": "OR",
                    "order": "count_desc",
                    "min_doc_count": 0
                },
                {
                    "field": "hasZoom",
                    "size": 10,
                    "operator": "AND",
                    "order": "term_asc",
                    "min_doc_count": 0
                },
                {
                    "field": "isDigitized",
                    "size": 10,
                    "operator": "AND",
                    "order": "count_desc",
                    "min_doc_count": 0
                },
                {
                    "field": "subject.exact",
                    "size": 15,
                    "operator": "AND",
                    "min_doc_count": 1
                },
                {
                    "field": "isPartOf.exact",
                    "size": 15,
                    "operator": "OR",
                    "order": "count_desc",
                    "min_doc_count": 1
                },
                {
                    "field": "producedIn.exact",
                    "size": 10,
                    "operator": "AND",
                    "order": "count_desc",
                    "min_doc_count": 1
                },
                {
                    "field": "maker.exact",
                    "size": 10,
                    "operator": "AND",
                    "order": "count_desc",
                    "min_doc_count": 1
                }
                //OBS: Supported intervals: weeks(w), days(d), hours(h), minutes(m), seconds(s)
                /*{
                 "field": "created",
                 "type" : "date_histogram",
                 "format" : "yyyy",
                 "interval" : "520w",
                 "min_doc_count" : 1,
                 "order" : "key_asc"
                 }*/
            ],
            tags: {
                "maker" : { queryField: "maker.exact", responseField: "maker", icon: "user", css: "maker"},
                "collection" : { queryField: "isPartOf.exact", responseField: "isPartOf", icon: "archive", css: "collection"},
                "spatial" : { queryField: "spatial.exact", responseField: "spatial", icon: "marker", css: "spatial"},
                "subject" : { queryField: "subject.exact", responseField: "subject", icon: "tag", css: "subject"},
                "type" : { queryField: "type.exact", responseField: "type", icon: "file outline", css: "type"},
                "isDigitized" : { queryField: "isDigitized", responseField: "", icon: "", css: "status"},
                "hasZoom" : { queryField: "hasZoom", responseField: "", icon: "", css: "status"},
            }
        });
</script>
</body>
</html>
